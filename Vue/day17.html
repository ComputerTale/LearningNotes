<html>
<head>
  <title>day17</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/601535 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1374"/>
<h1>day17</h1>

<div>
<span><div><div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">自定义指令</span></div><hr/><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">指令五类生命周期钩子Hooks</span></div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">bind(el,binding,vnode)</span></div><div>一旦指令绑定到元素，bind钩子就会被触发</div><div>el:指令所绑定的HTML元素</div><div>binding:使用指令时的配置：传入什么参数，什么修饰符</div><div>vnode:虚拟DOM中的节点</div><div>binding、vnode视为只读，被Vue本身操作</div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">inserted(el,binding,vnode)</span></div><div>成功插入到父节点</div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">updated(el,binding,vnode,oldVnode)</span></div><div>组件更新时会被调用(不包括子组件)</div><div>oldVnode:经过更新后虚拟DOM中有了新旧两个节点</div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">componentUpdated(el,binding,vnode,oldVnode)</span></div><div>所有组件全部更新完（包括子组件）</div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">unbind(el,binding,vnode)</span></div><div>一旦指令被溢出，unbind钩子就会被触发</div><hr/><div>对于一条语句</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>&lt;p v-text=&quot;'Some Text'&quot;&gt;&lt;/p&gt;</div></div><div>对于前面的v只是用来告诉Vue这不是可以忽略的普通HTML属性，而是需要处理的指令，不只是内置指令这样使用，所有指令都一样</div></div><div>后面跟着的text才是指令</div><hr/><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">全局注册自定义指令</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>main.js</div><div>// 全局注册</div><div>Vue.directive('highlight',{</div><div>bind(el,binding,vnode){</div><div>// el：绑定的HTML元素</div><div>// el.style.backgroundColor = 'green';</div><div>// binding.value：传入的值</div><div>// el.style.backgroundColor = binding.value;</div><div>// binding.value：传入的参数</div><div>var delay = 0;</div><div>// 检查传入的参数的修饰符</div><div>if(binding.modifiers['delayed']){</div><div>delay = 3000;</div><div>}</div><div>setTimeout(() =&gt; {</div><div>if(binding.arg == 'background'){</div><div>el.style.backgroundColor = binding.value;</div><div>}else{</div><div>el.style.color = binding.value;</div><div>}</div><div>},delay);</div><div>}</div><div>});</div><div><br/></div><div>使用</div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">App.vue</span></div><div>&lt;p v-highlight:background.delayed=&quot;'red'&quot;&gt;Colot this&lt;/p&gt;</div></div><hr/><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">局部注册自定义指令</span></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>App.vue</div><div>export default {</div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">directives</span>: {</div><div>&quot;local-highlight&quot;: {</div><div>bind(el, binding, vnode) {</div><div>var delay = 0;</div><div>// 检查传入的参数的修饰符</div><div>if (binding.modifiers[&quot;delayed&quot;]) {</div><div>delay = 3000;</div><div>}</div><div>if (binding.modifiers[&quot;blink&quot;]) {</div><div>//let是ES6的用法，类似var，具有局部变量作用</div><div>let mainColor = binding.value;</div><div>let secondColor = &quot;blue&quot;;</div><div>let currentColor = mainColor;</div><div>setTimeout(() =&gt; {</div><div>setInterval(() =&gt; {</div><div>currentColor == secondColor</div><div>? (currentColor = mainColor)</div><div>: (currentColor = secondColor);</div><div>if (binding.arg == &quot;background&quot;) {</div><div>el.style.backgroundColor = currentColor;</div><div>} else {</div><div>el.style.color = currentColor;</div><div>}</div><div>}, 1000);</div><div>}, delay);</div><div>} else {</div><div>setTimeout(() =&gt; {</div><div>if (binding.arg == &quot;background&quot;) {</div><div>el.style.backgroundColor = binding.value;</div><div>} else {</div><div>el.style.color = binding.value;</div><div>}</div><div>}, delay);</div><div>}</div><div>}</div><div>}</div><div>}</div><div>};</div><div>&lt;/script&gt;</div><div><br/></div><div>使用</div><div>&lt;p v-local-highlight:background.<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">delayed</span>.<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">blink</span>=&quot;'red'&quot;&gt;Colot this,too&lt;/p&gt;</div></div><div>使用自定义指令，设置指令自定义参数，自定义修饰符，自定义值</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>&lt;!-- 传入的值可以使字符串、对象... --&gt;</div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; background-color: rgb(255, 250, 165);-evernote-highlight:true;">local-hightlight:自定义指令名称</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; background-color: rgb(255, 250, 165);-evernote-highlight:true;">background:自定义参数</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; background-color: rgb(255, 250, 165);-evernote-highlight:true;">delayed、blink:自定义修饰符</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; background-color: rgb(255, 250, 165);-evernote-highlight:true;">{...}:自定义值</span></div><div>&lt;p v-local-highlight:background.delayed.blink=&quot;{mainColor:'red',secondColor:'green',delay:500}&quot;&gt;Colot this,too&lt;/p&gt;</div><div><br/></div><div>export default {</div><div>directives: {</div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; background-color: rgb(255, 250, 165);-evernote-highlight:true;">//自定义指令名称</span></div><div>&quot;<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">local-highlight</span>&quot;: {</div><div>bind(el, binding, vnode) {</div><div>var delay = 0;</div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">// 检查自定义修饰符</span></div><div>if (<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">binding.modifiers[&quot;delayed&quot;]</span>) {</div><div>delay = 3000;</div><div>}</div><div>if (<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">binding.modifiers[&quot;blink&quot;</span>]) {</div><div>//let是ES6的用法，类似var，具有局部变量作用</div><div>let mainColor = binding.value.mainColor;</div><div>let secondColor = binding.value.secondColor;</div><div>let currentColor = mainColor;</div><div>setTimeout(() =&gt; {</div><div>setInterval(() =&gt; {</div><div>currentColor == secondColor</div><div>? (currentColor = mainColor)</div><div>: (currentColor = secondColor);</div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; background-color: rgb(255, 250, 165);-evernote-highlight:true;">//检查自定义参数</span></div><div>if (<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">binding.arg == &quot;background&quot;</span>) {</div><div>el.style.backgroundColor = currentColor;</div><div>} else {</div><div>el.style.color = currentColor;</div><div>}</div><div>}, binding.value.delay);</div><div>}, delay);</div><div>} else {</div><div>setTimeout(() =&gt; {</div><div>if (<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">binding.arg == &quot;background&quot;</span>) {</div><div>el.style.backgroundColor = binding.value.mainColor;</div><div>} else {</div><div>el.style.color = binding.value.mainColor;</div><div>}</div><div>}, delay);</div><div>}</div><div>}</div><div>}</div><div>}</div><div>};</div></div><div><br/></div></span>
</div></body></html> 