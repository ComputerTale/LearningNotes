<html>
<head>
  <title>day18</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/601535 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1370"/>
<h1>day18</h1>

<div>
<span><div><div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">过滤器</span>：转换数据格式，并不是改变数据本身，只是转换给用户看</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">App.vue</span></div><div>&lt;!-- <span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">|表示管道符</span>，Vue会将符号前面的内容</div><div>作为参数传给函数 --&gt;</div><div>&lt;!-- <span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">串联过滤器</span>，每个管道符表示将前面处理的结果作为参数，</div><div>传给后面的函数 --&gt;</div><div>&lt;p&gt;{{ text | toUppercase |to-lowercase }}&lt;/p&gt;</div><div><br/></div><div>export default {</div><div>data(){</div><div>return{</div><div>text:'Hello there!',</div><div>fruits:['Apple','Banana','Mango','Melon'],</div><div>filterText:''</div><div>}</div><div>},</div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">// 局部过滤器</span></div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">filters</span>:{</div><div>//每个过滤器都应该有输入value</div><div>toUppercase(value){</div><div>return value.toUpperCase();</div><div>}</div><div>},</div><div>computed:{</div><div>}</div><div>}</div><div><br/></div><div>main.js</div><div><font face="Monaco" style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">//全局注册过滤器</font></div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">Vue.filter</span>('to-lowercase',function(value){</div><div>return value.toLowerCase();</div><div>})</div></div><hr/><div>过滤器的性能缺点</div><div>列表输出时，由于Vue没有在后台对filter进行优化，它不能检测是否需要重新运行过滤器（当元素内容没有发生变化时，比如字符串本身是小写，过滤器也是小写，这就不需要执行过滤器），而是每次都会重新加载，性能很差</div></div><div>为了避免这种情况发生，要<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">使用计算属性来替代过滤器</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>&lt;input type=&quot;text&quot; v-model=&quot;filterText&quot;&gt;</div><div>&lt;ul&gt;</div><div>&lt;li v-for=&quot;fruit in <span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">filteredFruits</span>&quot; :key=&quot;fruit&quot;&gt;</div><div>{{ fruit }}</div><div>&lt;/li&gt;</div><div>&lt;/ul&gt;</div><div><br/></div><div>&lt;script&gt;</div><div>export default {</div><div>data(){</div><div>return{</div><div>text:'Hello there!',</div><div>fruits:['Apple','Banana','Mango','Melon'],</div><div>filterText:''</div><div>}</div><div>},</div><div>// 局部过滤器</div><div>filters:{</div><div>//每个过滤器都应该有输入value</div><div>toUppercase(value){</div><div>return value.toUpperCase();</div><div>}</div><div>},</div><div>computed:{</div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">filteredFruits</span>(){</div><div>// js中Array的方法filter：不改变原数组，而是新建一个数组</div><div>// 新数组中均为符合条件的元素</div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">return this.fruits.filter((element)=&gt;{</span></div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">return element.match(this.filterText);</span></div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">});</span></div><div>}</div><div>}</div><div>}</div><div>&lt;/script&gt;</div></div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">总结：对于一些简单的情况直接使用过滤器即可，但是对于一些复杂的情况，使用计算属性会更好</span></div><div>这种情况就引入了一个问题，对于一些又需要重用的，又比较复杂的情况，我们不能使用全局注册过滤器来实现，因为性能浪费，这就需要<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">混入</span></div><hr/><div>混入机制</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">混入代码</span></div><div><span style="font-size: 9pt;color: rgb(51, 51, 51);font-family: Monaco;background-color: rgb(255, 250, 165);-evernote-highlight:true;">fruitMixin.js</span></div><div><font face="Monaco"><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">需要命名</span></font></div><div>export const <span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">fruitMixin</span> = {</div><div>data() {</div><div>return {</div><div>fruits: [&quot;Apple&quot;, &quot;Banana&quot;, &quot;Mango&quot;, &quot;Melon&quot;],</div><div>filterText: &quot;&quot;</div><div>};</div><div>},</div><div>computed: {</div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">filteredFruits</span>() {</div><div>// js中Array的方法filter：不改变原数组，而是新建一个数组</div><div>// 新数组中均为符合条件的元素</div><div>return this.fruits.filter(element =&gt; {</div><div>return element.match(this.filterText);</div><div>});</div><div>}</div><div>}</div><div>};</div><div><br/></div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">List.vue</span></div><div>&lt;template&gt;</div><div>&lt;div&gt;</div><div>&lt;input type=&quot;text&quot; v-model=&quot;filterText&quot; /&gt;</div><div>&lt;ul&gt;</div><div><font face="Monaco" style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">使用混用代码中的计算属性</font></div><div>&lt;li v-for=&quot;fruit in <span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">filteredFruits</span>&quot; :key=&quot;fruit&quot;&gt;{{ fruit }}&lt;/li&gt;</div><div>&lt;/ul&gt;</div><div>&lt;/div&gt;</div><div>&lt;/template&gt;</div><div>&lt;script&gt;</div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">//引入混入代码</span></div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">import { fruitMixin } from './fruitMixin.js';</span></div><div>export default {</div><div><span style="font-size: 9pt;color: rgb(51, 51, 51);font-family: Monaco;background-color: rgb(255, 250, 165);-evernote-highlight:true;">//声明混入代码</span></div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">mixins:[fruitMixin]</span></div><div>};</div><div>&lt;/script&gt;</div><div>&lt;style&gt;</div><div>&lt;/style&gt;</div><div><br/></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">App.vue</span></div><div>import List from './List.vue';</div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">//引入混入代码</span></div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">import { fruitMixin } from './fruitMixin.js';</span></div><div>export default {</div><div><span style="font-size: 9pt; font-family: Monaco; background-color: rgb(255, 255, 255);"><font color="#FF0000">//注意这里还有本身的data属性，说明Vue机制将自身声明的data属性和混入引入的data属性进行融合</font></span></div><div><font color="#FF0000">data(){</font></div><div><font color="#FF0000">return{</font></div><div><font color="#FF0000">text:'Hello there!'</font></div><div><font color="#FF0000">}</font></div><div>},</div><div>// 局部过滤器</div><div>filters:{</div><div>//每个过滤器都应该有输入value</div><div>toUppercase(value){</div><div>return value.toUpperCase();</div><div>}</div><div>},</div><div>components:{</div><div>appList:List</div><div>},</div><div><span style="font-size: 9pt;color: rgb(51, 51, 51);font-family: Monaco;background-color: rgb(255, 250, 165);-evernote-highlight:true;">//声明混入代码</span></div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">mixins:[fruitMixin]</span></div><div>}</div></div><hr/><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">混入机制</span></div><div>混入不会破坏组件原有的Vue实例，而是两者能够很好的结合</div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">混入代码与组件自身代码执行顺序</span>：</div><div>先执行混入代码，再执行组件代码</div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">特殊的全局混入</span>：不用再组件中声明，默认执行</div><div><span style="color: rgb(255, 0, 0);">注意：一般只在插件里面使用，实际开发一般不用</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">main.js</span></div><div>Vue.mixin({</div><div>created(){</div><div>console.log('Gloval Mixin - Created Hook');</div><div>}</div><div>})</div></div><div>执行顺序：</div><div>全局混入&gt;一般混入&gt;组件代码</div><div><img src="day18_files/Image.png" type="image/png" data-filename="Image.png"/></div><hr/><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">对于混入中data属性里面的变量，会在每一个使用混入的组件中新生成一个对象，而不是共享一个对象。</span></div><div>比如在混入里面定义的数组，在其中一个使用混入的组件中被修改，在其他组件下，数组状态不变。</div><div>如果需要在一个组件中改变而影响所有组件，可能使用之前的事件总线，即在main.js中定义一个evenBus</div><hr/><div>对于混入代码里面的计算属性，其使用的data属性中的变量可以不再混入代码中实现，但必须在组件代码中实现</div><div><br/></div></div><div><br/></div></span>
</div></body></html> 